<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nephilim Wars - Character Creator</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background-color: #0c0a09; 
            background-image: url("https://www.transparenttextures.com/patterns/dark-matter.png");
            color: #d6d3d1; 
            font-family: 'Cinzel', serif;
            min-height: 100vh;
            padding: 20px;
        }

        /* --- LAYOUT --- */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; 
            gap: 40px;
            max-width: 1400px;
            margin: 60px auto 0;
        }

        @media (max-width: 900px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        /* --- NAVIGATION --- */
        .nav-button {
            position: absolute; top: 20px; left: 20px;
            display: flex; align-items: center; gap: 10px;
            padding: 10px 20px; border-radius: 8px;
            background: rgba(28, 25, 23, 0.9); border: 1px solid #78350f;
            color: #fcd34d; text-decoration: none; font-weight: bold;
            text-transform: uppercase; letter-spacing: 1px;
            transition: all 0.3s ease; z-index: 10;
        }
        .nav-button:hover {
            border-color: #f59e0b; box-shadow: 0 0 15px rgba(245, 158, 11, 0.2);
        }

        /* --- LEFT PANEL: BUILDER --- */
        .builder-panel {
            background: rgba(28, 25, 23, 0.95);
            border: 2px solid #b45309;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            height: fit-content;
        }

        h1 {
            color: #fcd34d; font-size: 28px; text-align: center;
            margin-bottom: 20px; border-bottom: 1px solid #78350f; padding-bottom: 15px;
        }

        .form-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
        }

        /* New Grid for Stats to save space */
        .stats-input-grid {
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;
            grid-column: 1 / -1;
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #44403c;
        }

        .section-title {
            grid-column: 1 / -1; color: #f59e0b; font-size: 16px;
            margin-top: 15px; border-bottom: 1px solid #44403c; padding-bottom: 5px;
        }

        .input-group { display: flex; flex-direction: column; }

        label {
            font-size: 11px; color: #a8a29e; margin-bottom: 5px;
            text-transform: uppercase; letter-spacing: 1px;
        }

        select, input {
            padding: 10px; background: #0c0a09; border: 1px solid #57534e;
            color: #e7e5e4; font-family: 'Cinzel', serif; border-radius: 4px; font-size: 14px;
        }
        select:focus, input:focus { outline: none; border-color: #fcd34d; }

        .generate-btn {
            width: 100%; padding: 15px; margin-top: 25px;
            background: linear-gradient(135deg, #78350f 0%, #451a03 100%);
            border: 1px solid #f59e0b; color: #fcd34d; font-size: 18px;
            font-family: 'Cinzel', serif; font-weight: bold; cursor: pointer;
            text-transform: uppercase; letter-spacing: 2px; border-radius: 6px;
            transition: all 0.3s;
        }
        .generate-btn:hover {
            background: linear-gradient(135deg, #92400e 0%, #78350f 100%);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.4);
        }

        /* --- RIGHT PANEL: CHARACTER SHEET --- */
        .sheet-panel {
            position: sticky; top: 20px;
            background: #1c1917;
            border: 4px double #78350f;
            border-radius: 8px;
            padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
            min-height: 600px;
        }

        .sheet-header {
            width: 100%; text-align: center; margin-bottom: 20px;
        }
        .char-name {
            font-size: 32px; color: #fcd34d; text-shadow: 0 2px 4px black;
        }
        .char-subtitle {
            font-size: 16px; color: #a8a29e; font-style: italic;
        }

        /* PORTRAIT CONTAINER - UPDATED TO FIX ELONGATION */
        .portrait-frame {
            width: 100%; 
            max-width: 350px; /* FIX: Prevents getting massive on wide screens */
            margin: 0 auto;   /* FIX: Centers the frame */
            aspect-ratio: 2/3;
            background: #000;
            border: 2px solid #57534e;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
        }

        #char-image {
            width: 100%; height: 100%; object-fit: cover;
            display: none; /* Hidden until loaded */
        }

        .loading-spinner {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #f59e0b; font-size: 20px; text-transform: uppercase;
            animation: pulse 1s infinite;
        }

        .placeholder-text {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #44403c; text-align: center; width: 80%;
        }

        /* STATS BLOCK */
        .stats-grid {
            width: 100%; display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 10px; margin-top: 20px; border-top: 1px solid #44403c; padding-top: 20px;
        }
        .stat-box {
            background: #0c0a09; border: 1px solid #292524;
            padding: 10px; text-align: center; border-radius: 4px;
        }
        .stat-val { font-size: 18px; color: #e7e5e4; font-weight: bold; }
        .stat-label { font-size: 10px; color: #78716c; margin-top: 2px; }

        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

    </style>
</head>
<body>

    <nav class="nav-bar">
    <a href="../index.html" class="nav-link">üè† Home</a>
    <a href="../DiceRoller/index.html" class="nav-link">üé≤ Dice</a>
    <a href="../Combat/index.html" class="nav-link">‚öîÔ∏è Combat</a>
</nav>

    <div class="main-grid">
        
        <div class="builder-panel">
            <h1>Character Creator</h1>
            
            <div class="form-grid">
                
                <div class="input-group" style="grid-column: 1 / -1;">
                    <label>Character Name (Leave blank for Random)</label>
                    <input type="text" id="custom-name" placeholder="Enter Name or Leave Empty...">
                </div>

                <div class="section-title">Lineage & Origin</div>
                <div class="input-group">
                    <label>Race</label>
                    <select id="race">
                        <option value="Adamite">Adamite (Human)</option>
                        <option value="Nephilim">Nephilim (Giant-Kin)</option>
                        <option value="Rephaim">Rephaim (Shade/Giant)</option>
                        <option value="Lilin">Lilin (Night Spirit)</option>
                        <option value="Shedim">Shedim (Demon-Born)</option>
                        <option value="Anakim">Anakim (Long-Necked)</option>
                        <option value="Apkallu">Apkallu (Fish-Sage)</option>
                        <option value="Seraph-Kin">Seraph-Kin (Burning One)</option>
                        <option value="Cainite">Cainite (Marked Wanderer)</option>
                        <option value="Gammadim">Gammadim (Dwarven Warrior)</option>
                        <option value="Zamzummim">Zamzummim (Buzzing Giant)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Class</label>
                    <select id="class">
                        <option value="Gibbor">Gibbor (Mighty Warrior)</option>
                        <option value="Magi">Magi (Sorcerer)</option>
                        <option value="Kohen">Kohen (Priest)</option>
                        <option value="Scribe">Sofer (Scribe)</option>
                        <option value="Hunter">Nimrodian Hunter</option>
                        <option value="Ov">Ov (Necromancer)</option>
                        <option value="Nazarite">Nazarite (Zealot)</option>
                        <option value="Malakh">Malakh (Messenger/Scout)</option>
                        <option value="Baal-Priest">Cultist of Baal</option>
                        <option value="Artificer">Tubal-Cain Artificer</option>
                        <option value="Dreamer">Dreamer (Prophet)</option>
                        <option value="Judge">Judge (Tribal Leader)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Sex</label>
                    <select id="sex">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Androgynous">Androgynous</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Background</label>
                    <select id="background">
                        <option value="Shepherd">Shepherd of Tekoa</option>
                        <option value="Exile">Babylonian Exile</option>
                        <option value="Temple Guard">Temple Guard</option>
                        <option value="Desert Wanderer">Desert Wanderer</option>
                        <option value="Satrap">Royal Satrap (Noble)</option>
                        <option value="Essene">Essene Mystic</option>
                        <option value="Slave of Egypt">Slave of Egypt</option>
                        <option value="Temple Acolyte">Temple Acolyte</option>
                        <option value="Vineyard Keeper">Vineyard Keeper</option>
                        <option value="Charioteer">Assyrian Charioteer</option>
                        <option value="Leper Survivor">Leper Colony Survivor</option>
                    </select>
                </div>

                <div class="section-title">Base Attributes (Optional)</div>
                <div class="stats-input-grid">
                    <div class="input-group">
                        <label>STR</label>
                        <select id="base-str" class="stat-select"></select>
                    </div>
                    <div class="input-group">
                        <label>DEX</label>
                        <select id="base-dex" class="stat-select"></select>
                    </div>
                    <div class="input-group">
                        <label>CON</label>
                        <select id="base-con" class="stat-select"></select>
                    </div>
                    <div class="input-group">
                        <label>INT</label>
                        <select id="base-int" class="stat-select"></select>
                    </div>
                    <div class="input-group">
                        <label>WIS</label>
                        <select id="base-wis" class="stat-select"></select>
                    </div>
                    <div class="input-group">
                        <label>CHA</label>
                        <select id="base-cha" class="stat-select"></select>
                    </div>
                </div>

                <div class="section-title">Physique</div>
                <div class="input-group">
                    <label>Build</label>
                    <select id="build">
                        <option value="brawny and powerful">Brawny</option>
                        <option value="gaunt and fasting">Gaunt (Fasting)</option>
                        <option value="towering stature">Towering</option>
                        <option value="lithe and agile">Lithe</option>
                        <option value="portly and wealthy">Portly & Wealthy</option>
                        <option value="wiry and scorched">Wiry & Scorched</option>
                        <option value="hunchbacked">Hunchbacked</option>
                        <option value="statuesque perfection">Statuesque</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Skin</label>
                    <select id="skin">
                        <option value="sun-scorched">Sun-Scorched</option>
                        <option value="olive">Olive</option>
                        <option value="bronze-hued">Bronze-Hued</option>
                        <option value="ashen">Ashen/Grey</option>
                        <option value="luminous">Luminous (Shining)</option>
                        <option value="clay-like">Clay-Like</option>
                        <option value="ebony kushite">Ebony (Kushite)</option>
                        <option value="alabaster pale">Alabaster (Royal)</option>
                        <option value="copper-tone">Copper Tone</option>
                        <option value="bark-like">Bark-like Texture</option>
                        <option value="translucent">Translucent (Spirit)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Hair</label>
                    <select id="hair">
                        <option value="long uncut black">Uncut Black (Nazarite)</option>
                        <option value="braided beard">Braided Beard</option>
                        <option value="bald">Bald</option>
                        <option value="wild and matted">Wild & Matted</option>
                        <option value="white as wool">White as Wool</option>
                        <option value="fiery red">Fiery Red</option>
                        <option value="oiled ringlets">Oiled Assyrian Ringlets</option>
                        <option value="henna-dyed orange">Henna-Dyed Orange</option>
                        <option value="shaved with sidelocks">Shaved w/ Sidelocks</option>
                        <option value="serpentine strands">Serpentine Strands</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Eyes</label>
                    <select id="eyes">
                        <option value="dark brown">Dark Brown</option>
                        <option value="burning fire">Burning Fire</option>
                        <option value="milky white">Blind (Prophetic)</option>
                        <option value="piercing blue">Piercing Blue</option>
                        <option value="glowing amber">Glowing Amber</option>
                        <option value="starry void">Starry Void</option>
                        <option value="kohl-lined black">Kohl-Lined Black</option>
                        <option value="pale grey">Ghostly Grey</option>
                        <option value="vertical slits">Cat-like Slits</option>
                        <option value="solid black">Solid Black</option>
                    </select>
                </div>

                <div class="section-title">Biblical Traits</div>
                <div class="input-group">
                    <label>Feature 1 (Body)</label>
                    <select id="trait1">
                        <option value="">None</option>
                        <option value="six fingers on each hand">6 Fingers (Goliath-kin)</option>
                        <option value="horns of a ram">Ram Horns</option>
                        <option value="face of a lion">Face of a Lion (Cherubic)</option>
                        <option value="wings of an eagle">Eagle Wings</option>
                        <option value="covered in scales">Serpentine Scales</option>
                        <option value="glowing halo">Halo of Light</option>
                        <option value="leprosy scars">Leprosy Scars</option>
                        <option value="cloven hooves">Cloven Hooves</option>
                        <option value="glowing script on skin">Glowing Skin-Script</option>
                        <option value="face half gold">Face Half-Gold</option>
                        <option value="shadow detached">Detached Shadow</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Feature 2 (Held/Worn)</label>
                    <select id="trait2">
                        <option value="">None</option>
                        <option value="wearing sackcloth">Sackcloth & Ashes</option>
                        <option value="carrying a bronze spear">Bronze Spear</option>
                        <option value="holding a scroll">Ancient Scroll</option>
                        <option value="wielding a flaming sword">Flaming Sword</option>
                        <option value="wearing the breastplate of judgment">Priestly Breastplate</option>
                        <option value="carrying a sling">Shepherd's Sling</option>
                        <option value="holding a severed head">Severed Head</option>
                        <option value="wielding a jawbone">Donkey Jawbone</option>
                        <option value="wearing a lion pelt">Lion Pelt</option>
                        <option value="holding a censer">Incense Censer</option>
                        <option value="playing a lyre">Wooden Lyre</option>
                    </select>
                </div>
                
                <div class="section-title">Location</div>
                <div class="input-group" style="grid-column: 1 / -1;">
                    <label>Scene Setting</label>
                    <select id="vibe">
                        <option value="Walls of Jericho">Walls of Jericho</option>
                        <option value="Ziggurat of Ur">Ziggurat of Ur</option>
                        <option value="Caves of Qumran">Caves of Qumran</option>
                        <option value="Mount Hermon snow">Mount Hermon (Snow)</option>
                        <option value="Gardens of Babylon">Gardens of Babylon</option>
                        <option value="Valley of Dry Bones">Valley of Dry Bones</option>
                        <option value="Temple Holy of Holies">Temple Interior</option>
                        <option value="Red Sea Crossing">Red Sea Crossing</option>
                        <option value="Tower of Babel Construction">Tower of Babel</option>
                        <option value="Tent of Meeting">Tent of Meeting</option>
                        <option value="Throne Room of Nineveh">Throne of Nineveh</option>
                        <option value="Burning Bush Wilderness">Burning Bush Wilderness</option>
                    </select>
                </div>

            </div>

            <button class="generate-btn" onclick="generateCharacter()">‚ú® Summon Character</button>
        </div>

        <div class="sheet-panel">
            <div class="sheet-header">
                <div class="char-name" id="display-name">Unknown Soul</div>
                <div class="char-subtitle" id="display-subtitle">Wanderer of the Waste</div>
            </div>

            <div class="portrait-frame">
                <div id="loading" class="loading-spinner" style="display: none;">Consulting the Oracle...</div>
                <div id="placeholder" class="placeholder-text">Portrait will appear here</div>
                <img id="char-image" alt="Character Portrait">
            </div>

            <div class="stats-grid">
                <div class="stat-box"><div class="stat-val" id="str-val">10</div><div class="stat-label">STR</div></div>
                <div class="stat-box"><div class="stat-val" id="dex-val">10</div><div class="stat-label">DEX</div></div>
                <div class="stat-box"><div class="stat-val" id="con-val">10</div><div class="stat-label">CON</div></div>
                <div class="stat-box"><div class="stat-val" id="int-val">10</div><div class="stat-label">INT</div></div>
                <div class="stat-box"><div class="stat-val" id="wis-val">10</div><div class="stat-label">WIS</div></div>
                <div class="stat-box"><div class="stat-val" id="cha-val">10</div><div class="stat-label">CHA</div></div>
            </div>

            <div style="margin-top: 20px; font-size: 12px; color: #57534e; text-align: center;">
                Nephilim Wars Character Sheet v0.5
            </div>
        </div>
    </div>

    <script>
        // Init Stat Dropdowns
        const statSelects = document.querySelectorAll('.stat-select');
        statSelects.forEach(sel => {
            const randOpt = document.createElement('option');
            randOpt.value = 'random';
            randOpt.textContent = 'üé≤ Roll';
            sel.appendChild(randOpt);
            
            for(let i=3; i<=18; i++) {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = i;
                if(i===10) opt.selected = false; 
                sel.appendChild(opt);
            }
        });

        const names = {
            Male: ["Enoch", "Nimrod", "Gilgamesh", "Methuselah", "Jared", "Lamech", "Barak", "Goliath", "Og", "Sennacherib", "Nebuchadnezzar", "Cyrus", "Darius", "Tubal-Cain", "Canaan", "Hittite"],
            Female: ["Lilith", "Semiramis", "Jezebel", "Deborah", "Salome", "Athaliah", "Hagar", "Tiamat", "Ishtar", "Naamah", "Delilah", "Bathsheba"],
            Androgynous: ["Azazel", "Samyaza", "Baraqiel", "Kokabiel", "Tamiel", "Ramiel", "Daniel", "Uriel", "Sariel"]
        };

        const titles = ["the Accursed", "of the Watchers", "the Giant", "Light-Bringer", "of Ur", "the Scribe", "Star-Gazer", "Iron-Heart", "Baal-Worshipper", "Yahweh-Fearer", "of the Dust", "the Unclean", "of the Pit"];

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function getStatValue(id) {
            const val = document.getElementById(id).value;
            if(val === 'random') return getRandomInt(8, 15); // Standard roll range
            return parseInt(val);
        }

        function generateStats(cls) {
            // Get base stats (either random or manual override)
            let stats = {
                str: getStatValue('base-str'),
                dex: getStatValue('base-dex'),
                con: getStatValue('base-con'),
                int: getStatValue('base-int'),
                wis: getStatValue('base-wis'),
                cha: getStatValue('base-cha')
            };
            
            // Add Class Bonuses (Mechanics apply on top of base)
            if(cls === 'Gibbor' || cls === 'Hunter' || cls === 'Gammadim' || cls === 'Zamzummim') { stats.str += 4; stats.con += 2; }
            if(cls === 'Nazarite' || cls === 'Kohen' || cls === 'Judge') { stats.wis += 4; stats.cha += 2; }
            if(cls === 'Magi' || cls === 'Scribe' || cls === 'Ov' || cls === 'Artificer') { stats.int += 5; stats.wis += 2; }
            if(cls === 'Malakh' || cls === 'Charioteer') { stats.dex += 4; stats.int += 1; }
            
            return stats;
        }

        function generateCharacter() {
            // 1. Gather Data
            const customName = document.getElementById('custom-name').value;
            const race = document.getElementById('race').value;
            const cls = document.getElementById('class').value;
            const sex = document.getElementById('sex').value;
            const background = document.getElementById('background').value;
            const build = document.getElementById('build').value;
            const skin = document.getElementById('skin').value;
            const hair = document.getElementById('hair').value;
            const eyes = document.getElementById('eyes').value;
            const trait1 = document.getElementById('trait1').value;
            const trait2 = document.getElementById('trait2').value;
            const vibe = document.getElementById('vibe').value;

            // 2. Generate Prompt for AI (Updated for PHOTOREALISM)
            let prompt = `cinematic shot, 35mm photograph, live action movie still, ancient near east, ${sex} ${race} ${cls}, ${build} body, ${skin} skin, ${hair} hair, ${eyes} eyes, wearing ancient bronze age armor and robes.`;
            
            if(trait1) prompt += ` Distinct feature: ${trait1}.`;
            if(trait2) prompt += ` Holding: ${trait2}.`;
            
            prompt += ` Background: ${vibe}. Style: hyperrealistic, highly detailed skin texture, sharp focus, volumetric lighting, 8k uhd, HDR, anatomically correct, masterpiece.`;

            // Negative Prompt
            const negative = "cartoon, anime, illustration, painting, drawing, cgi, 3d render, sketch, low quality, deformed, ugly, blur, bad anatomy, extra limbs, disfigured, watermark, text";

            // 3. Update UI - Text
            let name = "";
            if (customName.trim() !== "") {
                name = customName;
            } else {
                const firstNames = names[sex] || names['Male'];
                name = firstNames[Math.floor(Math.random() * firstNames.length)] + " " + titles[Math.floor(Math.random() * titles.length)];
            }

            const cleanRace = race.split(' ')[0];
            const cleanClass = cls.split(' ')[0];
            
            document.getElementById('display-name').innerText = name;
            document.getElementById('display-subtitle').innerText = `${cleanRace} ${cleanClass} (${background})`;

            const stats = generateStats(cleanClass);
            document.getElementById('str-val').innerText = stats.str;
            document.getElementById('dex-val').innerText = stats.dex;
            document.getElementById('con-val').innerText = stats.con;
            document.getElementById('int-val').innerText = stats.int;
            document.getElementById('wis-val').innerText = stats.wis;
            document.getElementById('cha-val').innerText = stats.cha;

            // 4. Update UI - Image
            const imgElement = document.getElementById('char-image');
            const loading = document.getElementById('loading');
            const placeholder = document.getElementById('placeholder');

            imgElement.style.display = 'none';
            placeholder.style.display = 'none';
            loading.style.display = 'block';

            const encodedPrompt = encodeURIComponent(prompt);
            const encodedNegative = encodeURIComponent(negative);
            const seed = Math.floor(Math.random() * 100000);
            
            // FIX: Reduced resolution to 320x480 for Speed. Kept ratio 2:3.
            const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?width=320&height=480&seed=${seed}&nologo=true&model=flux&negative=${encodedNegative}`;

            imgElement.onload = function() {
                loading.style.display = 'none';
                imgElement.style.display = 'block';
            };

            imgElement.src = imageUrl;
        }
    </script>
</body>
</html>