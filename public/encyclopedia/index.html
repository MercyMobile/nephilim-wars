<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nephilim Wars - Lore Codex</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background-color: #0c0a09; 
            background-image: url("https://www.transparenttextures.com/patterns/dark-matter.png");
            color: #d6d3d1; 
            font-family: 'Cinzel', serif;
            min-height: 100vh;
            padding: 20px;
        }

        /* --- NAVIGATION BAR --- */
        .nav-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background: rgba(28, 25, 23, 0.95);
            border-bottom: 2px solid #78350f;
            padding: 15px 20px;
            display: flex; gap: 20px; z-index: 100;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.8);
        }

        /* Hide nav when in iframe */
        body.in-iframe .nav-bar { display: none; }
        body.in-iframe .container { margin-top: 20px; }

        .nav-link {
            color: #fcd34d; text-decoration: none; font-weight: bold;
            text-transform: uppercase; letter-spacing: 1px; font-size: 14px;
            transition: all 0.3s; display: flex; align-items: center; gap: 8px;
        }
        .nav-link:hover { color: #fff; text-shadow: 0 0 10px #f59e0b; }

        /* --- MAIN CONTAINER --- */
        .container {
            max-width: 1400px; margin: 80px auto 40px;
            padding: 20px;
        }

        header {
            text-align: center; margin-bottom: 40px;
            border-bottom: 1px solid #78350f; padding-bottom: 20px;
        }

        h1 {
            color: #fcd34d; font-size: 3rem; margin-bottom: 10px;
            text-shadow: 0 4px 10px rgba(0,0,0,0.8); letter-spacing: 4px;
        }

        .subtitle { color: #a8a29e; font-size: 1.1rem; text-transform: uppercase; letter-spacing: 2px; }

        /* --- SEARCH & FILTERS --- */
        .controls-area {
            display: flex; flex-direction: column; align-items: center; gap: 20px; margin-bottom: 40px;
        }

        #searchInput {
            width: 100%; max-width: 600px; padding: 15px;
            background: #1c1917; border: 1px solid #78350f;
            color: #fcd34d; font-family: 'Cinzel', serif; font-size: 16px;
            border-radius: 4px; box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        #searchInput:focus { outline: none; border-color: #f59e0b; box-shadow: 0 0 15px rgba(245, 158, 11, 0.2); }

        .filter-tabs { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }

        .filter-btn {
            padding: 10px 20px; background: #292524; border: 1px solid #57534e;
            color: #a8a29e; cursor: pointer; font-family: 'Cinzel', serif;
            text-transform: uppercase; transition: all 0.3s;
        }
        .filter-btn:hover { border-color: #f59e0b; color: #f59e0b; }
        .filter-btn.active { background: #78350f; color: #fff; border-color: #f59e0b; }

        /* --- GRID --- */
        .entries-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .entry-card {
            background: rgba(28, 25, 23, 0.8);
            border: 1px solid #44403c;
            border-radius: 6px; padding: 25px;
            cursor: pointer; transition: all 0.3s;
            position: relative; overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
        }

        .entry-card:hover {
            transform: translateY(-5px);
            border-color: #f59e0b;
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.15);
        }

        .entry-card.angel { border-top: 3px solid #3b82f6; } /* Blue for Angels */
        .entry-card.demon { border-top: 3px solid #ef4444; } /* Red for Demons */

        .card-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px; }
        .card-name { font-size: 1.4rem; color: #fcd34d; font-weight: bold; }
        .card-type { 
            font-size: 0.7rem; padding: 2px 8px; border-radius: 4px; text-transform: uppercase; 
            background: #000; color: #78716c; border: 1px solid #292524;
        }
        
        .card-hebrew { font-size: 0.9rem; color: #78716c; margin-bottom: 15px; font-family: sans-serif; }
        .card-desc { font-size: 0.95rem; color: #d6d3d1; line-height: 1.6; font-family: sans-serif; flex-grow: 1;}

        /* --- MODAL --- */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000; overflow-y: auto; padding: 40px 20px;
        }

        .modal-content {
            max-width: 900px; margin: 40px auto;
            background: #1c1917; border: 2px solid #78350f;
            padding: 40px; position: relative;
            box-shadow: 0 0 50px rgba(245, 158, 11, 0.1);
        }

        .close-btn {
            position: absolute; top: 20px; right: 20px;
            color: #78716c; font-size: 2rem; cursor: pointer; transition: 0.3s;
        }
        .close-btn:hover { color: #f59e0b; }

        .modal-title { font-size: 2.5rem; color: #fcd34d; margin-bottom: 5px; }
        .modal-hebrew { font-size: 1.2rem; color: #a8a29e; margin-bottom: 30px; border-bottom: 1px solid #44403c; padding-bottom: 15px;}
        
        .modal-section { margin-bottom: 25px; }
        
        /* FIX: 'white-space: normal' ensures HTML tags handle spacing, not code indentation */
        .modal-text { color: #d6d3d1; line-height: 1.8; font-family: sans-serif; white-space: normal; }
        
        .modal-label { color: #f59e0b; font-size: 1rem; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; border-left: 3px solid #f59e0b; padding-left: 10px; }
        
        .source-box { 
            background: #0c0a09; padding: 20px; border: 1px solid #44403c; margin-top: 30px; 
            font-family: sans-serif; font-size: 0.9rem; color: #78716c;
        }
        .source-box ul { padding-left: 20px; margin-top: 10px; }
        .source-box li { margin-bottom: 5px; }

    </style>
</head>
<body>

    <nav class="nav-bar">
    <a href="../index.html" class="nav-link">üè† Home</a>
    <a href="../DiceRoller/index.html" class="nav-link">üé≤ Dice</a>
    <a href="../Combat/index.html" class="nav-link">‚öîÔ∏è Combat</a>
	<a href="nephilim_wars_races_and_peoples.html" class="nav-btn">
    <span class="icon">üë•</span> Races & Peoples
</a>
</nav>

    <div class="container">
        <header>
            <h1>Codex Angelorum</h1>
            <div class="subtitle">Complete Records from the Dead Sea Scrolls & Enochian Texts</div>
        </header>

        <div class="controls-area">
            <input type="text" id="searchInput" placeholder="Search entries (e.g., 'Watcher', 'Fire', 'Nephilim')...">
            
            <div class="filter-tabs">
                <button class="filter-btn active" data-filter="all">All Entries</button>
                <button class="filter-btn" data-filter="angel">Angels</button>
                <button class="filter-btn" data-filter="demon">Demons / Fallen</button>
                <button class="filter-btn" data-filter="archangel">Archangels</button>
            </div>
        </div>

        <div class="entries-grid" id="grid">
            </div>
    </div>

    <div class="modal-overlay" id="modal">
        <div class="modal-content" id="modal-body">
            </div>
    </div>

    <script src="data.js"></script>

    <script>
        // Detect if in iframe and hide nav
        if (window.self !== window.top) {
            document.body.classList.add('in-iframe');
        }

        // --- RENDER LOGIC ---
        // 'database' is now loaded from data.js
        const grid = document.getElementById('grid');
        const modal = document.getElementById('modal');
        const modalBody = document.getElementById('modal-body');
        const searchInput = document.getElementById('searchInput');
        const btns = document.querySelectorAll('.filter-btn');

        let currentFilter = 'all';

        function render(filter = 'all', search = '') {
            grid.innerHTML = '';
            
            // Check if database loaded
            if (typeof database === 'undefined') {
                grid.innerHTML = '<div style="color:red;">Error: data.js not loaded. Check file path.</div>';
                return;
            }

            const filtered = database.filter(item => {
                const matchesFilter = filter === 'all' || item.type === filter || item.category === filter;
                const matchesSearch = item.name.toLowerCase().includes(search.toLowerCase()) || 
                                      item.description.toLowerCase().includes(search.toLowerCase());
                return matchesFilter && matchesSearch;
            });

            filtered.forEach(item => {
                const card = document.createElement('div');
                card.className = `entry-card ${item.type}`;
                card.innerHTML = `
                    <div class="card-header">
                        <span class="card-name">${item.name}</span>
                        <span class="card-type ${item.type}">${item.category}</span>
                    </div>
                    <div class="card-hebrew">${item.hebrew}</div>
                    <div class="card-desc">${item.description}</div>
                `;
                card.onclick = () => openModal(item);
                grid.appendChild(card);
            });
        }

        function openModal(item) {
            modalBody.innerHTML = `
                <span class="close-btn" onclick="closeModal()">&times;</span>
                <div class="modal-title" style="color: ${item.type === 'angel' ? '#3b82f6' : '#ef4444'}">${item.name}</div>
                <div class="modal-hebrew">${item.hebrew}</div>
                
                <div class="modal-section">
                    <div class="modal-label">Detailed Lore</div>
                    <div class="modal-text">${item.fullDescription}</div>
                </div>

                ${item.role ? `
                <div class="modal-section">
                    <div class="modal-label">Primary Role</div>
                    <div class="modal-text">${item.role}</div>
                </div>` : ''}

                ${item.hierarchy ? `
                <div class="modal-section">
                    <div class="modal-label">Hierarchy</div>
                    <div class="modal-text">${item.hierarchy}</div>
                </div>` : ''}

                ${item.attributes ? `
                <div class="modal-section">
                    <div class="modal-label">Attributes</div>
                    <div class="modal-text">${item.attributes}</div>
                </div>` : ''}

                <div class="modal-section">
                    <div class="modal-label">Biblical References</div>
                    <div class="modal-text">${item.biblicalReferences || 'None'}</div>
                </div>

                <div class="modal-section">
                    <div class="modal-label">Extra-Biblical / Apocrypha</div>
                    <div class="modal-text">${item.extraBiblical || 'None'}</div>
                </div>

                <div class="source-box">
                    <strong>&#128218; Sources:</strong>
                    <ul>${item.sources.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>
            `;
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        window.closeModal = function() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // --- EVENT LISTENERS ---
        searchInput.addEventListener('input', (e) => render(currentFilter, e.target.value));

        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                btns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                render(currentFilter, searchInput.value);
            });
        });

        modal.addEventListener('click', (e) => {
            if(e.target === modal) closeModal();
        });

        render();
    </script>
</body>
</html>